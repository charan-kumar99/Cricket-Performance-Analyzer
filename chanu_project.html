<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title> Cricket Performance Analyzer Using Rate and Boundary Metrics</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 20px;
      background: url("image2.jpg") no-repeat center center fixed;
      background-size: cover;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      background: rgba(255, 255, 255, 0.75);
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
      backdrop-filter: blur(10px);
    }
    h1 {
      text-align: center;
      color: #111;
      font-size: 2rem;
      margin-bottom: 25px;
    }
    form input, form button {
      padding: 10px;
      margin: 5px;
      font-size: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      outline: none;
    }
    form button {
      background-color: #007bff;
      color: white;
      border: none;
      font-weight: bold;
    }
    #message {
      font-weight: bold;
      margin: 10px 0;
      color: green;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #333;
      color: white;
    }
    td {
      background-color: rgba(255, 255, 255, 0.95);
    }
    #total {
      font-size: 18px;
      font-weight: 600;
      color: #222;
      text-align: right;
      margin-top: 10px;
    }
    .buttons {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .buttons button, .buttons input[type="file"] {
      background-color: #111;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    #search-box, #ai-input {
      margin: 10px 0;
      padding: 10px;
      width: 100%;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .edit-button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
    #ai-response {
      margin-top: 10px;
      font-weight: bold;
      color: #222;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1> Cricket Performance Analyzer Using Rate and Boundary Metrics</h1>
    <form id="player-form">
      <input type="text" id="player-name" placeholder="Player Name" required pattern="^[^\d]+$" title="Name cannot contain numbers">
      <input type="number" id="runs" placeholder="Runs" required>
      <input type="number" id="fours" placeholder="Fours">
      <input type="number" id="sixes" placeholder="Sixes">
      <input type="number" id="balls" placeholder="Balls" required>
      <button type="submit">Add Player</button>
      <button type="button" onclick="document.getElementById('csv-input').click()">Choose File</button>
      <input type="file" id="csv-input" accept=".csv" style="display:none">
    </form>

    <input type="text" id="search-box" placeholder="Search by player name...">
    <div class="section" id="message"></div>

    <table>
      <thead>
        <tr>
          <th>Player</th>
          <th>Runs</th>
          <th>Fours</th>
          <th>Sixes</th>
          <th>Balls</th>
          <th>Strike Rate</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="scorecard-body"></tbody>
    </table>

    <div id="total">Total Runs: 0</div>

    <div class="buttons">
      <button onclick="clearAll()">Clear All</button>
      <button onclick="downloadCSV()">Download CSV</button>
    </div>

    <!-- AI Assistant -->
    <input type="text" id="ai-input" placeholder="Ask something like 'Show Virat Kohli stats' or 'Who has the best strike rate'...">
    <div id="ai-response"></div>
  </div>

  <script>
    let players = [];

    function calculateStrikeRate(runs, balls) {
      return balls === 0 ? 'N/A' : ((runs / balls) * 100).toFixed(2);
    }

    function updateTable(filter = '') {
      const tbody = document.getElementById('scorecard-body');
      tbody.innerHTML = '';
      let total = 0;
      players.filter(p => p.name.toLowerCase().includes(filter.toLowerCase())).forEach((p, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.name}</td>
          <td>${p.runs}</td>
          <td>${p.fours ?? '-'}</td>
          <td>${p.sixes ?? '-'}</td>
          <td>${p.balls}</td>
          <td>${calculateStrikeRate(p.runs, p.balls)}</td>
          <td><button class="edit-button" onclick="editPlayer(${index})">Edit</button></td>
        `;
        tbody.appendChild(tr);
        total += p.runs;
      });
      document.getElementById('total').textContent = `Total Runs: ${total}`;
    }

    document.getElementById('player-form').addEventListener('submit', e => {
      e.preventDefault();
      const name = document.getElementById('player-name').value.trim();
      const runs = parseInt(document.getElementById('runs').value);
      const fours = parseInt(document.getElementById('fours').value) || 0;
      const sixes = parseInt(document.getElementById('sixes').value) || 0;
      const balls = parseInt(document.getElementById('balls').value);
      if (isNaN(runs) || isNaN(balls) || !name || /\d/.test(name)) {
        document.getElementById('message').textContent = 'Invalid input';
        return;
      }
      const boundaryRuns = fours * 4 + sixes * 6;
      const totalBoundaries = fours + sixes;
      if (boundaryRuns > runs || runs > balls * 6 || totalBoundaries > balls || (runs > 4 && fours === 0 && sixes === 0)) {
        document.getElementById('message').textContent = 'Inconsistent run data';
        return;
      }
      players.unshift({ name, runs, fours, sixes, balls });
      updateTable(document.getElementById('search-box').value);
      document.getElementById('message').textContent = 'Player added';
      e.target.reset();
    });

    function editPlayer(index) {
      const player = players[index];
      document.getElementById('player-name').value = player.name;
      document.getElementById('runs').value = player.runs;
      document.getElementById('fours').value = player.fours;
      document.getElementById('sixes').value = player.sixes;
      document.getElementById('balls').value = player.balls;
      players.splice(index, 1);
      updateTable(document.getElementById('search-box').value);
    }

    document.getElementById('search-box').addEventListener('input', () => {
      updateTable(document.getElementById('search-box').value);
    });

    function clearAll() {
      if (confirm('Are you sure?')) {
        players = [];
        updateTable();
        document.getElementById('message').textContent = 'All data cleared';
      }
    }

    function downloadCSV() {
      if (players.length === 0) return;
      const rows = [['Name', 'Runs', 'Fours', 'Sixes', 'Balls']].concat(
        players.map(p => [p.name, p.runs, p.fours, p.sixes, p.balls])
      );
      const csvContent = rows.map(e => e.join(",")).join("\n");
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'players.csv';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    document.getElementById('csv-input').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function (event) {
        const lines = event.target.result.trim().split('\n');
        lines.forEach(line => {
          const [name, runs, fours = 0, sixes = 0, balls] = line.split(',').map(v => v.trim());
          if (!name || /\d/.test(name) || isNaN(runs) || isNaN(balls)) return;
          players.unshift({
            name,
            runs: parseInt(runs),
            fours: parseInt(fours),
            sixes: parseInt(sixes),
            balls: parseInt(balls)
          });
        });
        updateTable(document.getElementById('search-box').value);
        document.getElementById('message').textContent = 'CSV Imported';
      };
      reader.readAsText(file);
    });

    // AI Assistant logic
    document.getElementById('ai-input').addEventListener('keydown', function (e) {
      if (e.key === 'Enter') {
        const query = e.target.value.toLowerCase().trim();
        let response = '';
        if (query.includes("best strike rate")) {
          let best = players.reduce((a, b) => {
            return (calculateStrikeRate(b.runs, b.balls) > calculateStrikeRate(a.runs, a.balls)) ? b : a;
          }, players[0]);
          response = `Best Strike Rate: ${best.name} (${calculateStrikeRate(best.runs, best.balls)})`;
        } else if (query.includes("total runs")) {
          const total = players.reduce((sum, p) => sum + p.runs, 0);
          response = `Total Runs: ${total}`;
        } else if (query.includes("most runs")) {
          let top = players.reduce((a, b) => a.runs > b.runs ? a : b, players[0]);
          response = `Most Runs: ${top.name} (${top.runs})`;
        } else {
          const match = query.match(/show\s+(.*?)\s+stats/i) || query.match(/stats\s+for\s+(.*)/i) || query.match(/stats\s+of\s+(.*)/i);
          if (match) {
            const name = match[1].trim().toLowerCase();
            const player = players.find(p => p.name.toLowerCase() === name);
            if (player) {
              response = `${player.name}'s Stats â€” Runs: ${player.runs}, Fours: ${player.fours}, Sixes: ${player.sixes}, Balls: ${player.balls}, Strike Rate: ${calculateStrikeRate(player.runs, player.balls)}`;
            } else {
              response = `Player "${match[1]}" not found.`;
            }
          } else {
            response = "Sorry, I don't understand the question.";
          }
        }
        document.getElementById('ai-response').textContent = response;
        e.target.value = '';
      }
    });
  </script>
</body>
</html>
